<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" ></script>
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	<title>LOGIN</title>
</head>
<body>

  <form name="login_form" id="login_form" method="post" action="#" enctype="multipart/form-data" >
    <div class="col-sm-4">
      <div class="form-group">
          <label for="email">Email </label>
        <input type="text" name="login_email" id="login_email" class="form-control" onchange="validateFields()" placeholder="Entre com seu email">
      </div>
      
      <div class="form-group">
          <label for="password">Senha</label>
        <input type="password" name="login_password" id="login_password" class="form-control"  placeholder="Entre com sua senha">
      </div>
      <button type="button" id="login" name="login" class="btn btn-success" disabled="true">Logar</button>
    </div>


  </body>
  <script>
function validateFields(){
		const email = document.getElementById("login_email").value;
		if(!email){ 
			document.getElementById('login').disabled = true;
	
			}else if(validateEmail(email)){
				document.getElementById('login').disabled = false;
			}else {document.getElementById('login').disabled = true;}
	  }

	  function validateEmail(email){
		return /\S+@\S+\.\S+/.test(email);
	  }



  </script>
  <script type="module">
	  // Import the functions you need from the SDKs you need
	  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js";
	  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-analytics.js";
	  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-auth.js";
	  // TODO: Add SDKs for Firebase products that you want to use
	  // https://firebase.google.com/docs/web/setup#available-libraries

	  // Your web app's Firebase configuration
	  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
	  const firebaseConfig = {
	    apiKey: "AIzaSyCV2Eu8UdJX2_9FYVLFTV4aF_hLQJ4Edj8",
  		authDomain: "marmore-9e301.firebaseapp.com",
		databaseURL: "https://marmore-9e301-default-rtdb.firebaseio.com",
		projectId: "marmore-9e301",
		storageBucket: "marmore-9e301.appspot.com",
		messagingSenderId: "213981622362",
		appId: "1:213981622362:web:2638b873284157c055e863"
	  };

	  // Initialize Firebase
	  const app = initializeApp(firebaseConfig);
	  const analytics = getAnalytics(app);
	  const auth = getAuth();
	  console.log(app);

	  

    //----- Login code start	  
	  document.getElementById("login").addEventListener("click", function() {
		  var email =  document.getElementById("login_email").value;
		  var password = document.getElementById("login_password").value;
			
		  signInWithEmailAndPassword(auth, email, password)
		  .then((userCredential) => {
		    // Signed in 
		    const user = userCredential.user;
		    console.log(user);
		    alert(user.email+" Login feito com sucesso!!!");
			  location.href = "./tela_inicial/tela_inicial.html";	
		    
			
		    // ...
		  })
		  .catch((error) => {
		    alert("Usuario ou senha inv√°lido!");
		  });	
		    		  
	  });

    </script>
</html>
